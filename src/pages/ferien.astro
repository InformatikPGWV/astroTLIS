---
import Layout from "../layouts/Layout.astro";
---

<Layout
  title="Fehlerportal - About"
  bodyClass="bg-slate-900 overflow-hidden text-white drop-shadow-md bg-no-repeat bg-cover bg-center bg-[url('https://images.unsplash.com/photo-1505228395891-9a51e7e86bf6')] backdrop-blur-sm backdrop-brightness-[0.8]"
>
  <div class="flex justify-center items-center h-screen">
    <h1 class="text-center font-bold text-[8rem] select-none mr-3">ðŸŽ‰</h1>
    <h1 class="text-center font-bold text-[10rem] select-none">Ferien</h1>
    <h1 class="text-center font-bold text-[8rem] select-none ml-3">ðŸŽ‰</h1>
  </div>
</Layout>

<script>
  let requestTries = 0;
  async function getData(url: string, setTries: boolean = true) {
    if (setTries) {
      requestTries = 0;
    }
    requestTries++;
    if (requestTries <= 5) {
      let request = await fetch(url);
      if (request.status == 200) {
        console.log("ðŸŽ‰ Collected Data: " + requestURL);
        return request;
      } else {
        getData(url, false);
      }
    }
  }

  async function parseData(request) {
    let parsedData = await request.json();
    // console.log(parsedData);
    // for (let i in await parsedData) {
    //   console.log(i);
    // }
  }

  const requestURL =
    "https://ferien-api.de/api/v1/holidays/NI/" +
    new Date().getFullYear().toString();

  parseData(getData(requestURL));
</script>

<!-- CONFETTI -->
<script>
  import confetti from "canvas-confetti";
  import $ from "jquery";

  $(function () {
    // var duration = 15 * 1000;
    // var animationEnd = Date.now() + duration;

    var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };
    function randomInRange(min, max) {
      return Math.random() * (max - min) + min;
    }
    var interval = setInterval(function () {
      // var timeLeft = animationEnd - Date.now();
      // if (timeLeft <= 0) {
      //   return clearInterval(interval);
      // }

      var particleCount = 35;
      // since particles fall down, start a bit higher than random
      confetti(
        Object.assign({}, defaults, {
          particleCount,
          // origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 },
          origin: { x: randomInRange(0, 1), y: Math.random() - 0.2 },
        })
      );
      // confetti(
      //   Object.assign({}, defaults, {
      //     particleCount,
      //     // origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 },
      //     origin: { x: randomInRange(0, 1), y: Math.random() - 0.2 },
      //   })
      // );
    }, 500);
  });
</script>

<style>
  /* body {
    overflow: hidden;
  } */
</style>
